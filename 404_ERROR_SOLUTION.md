# üîß 404 Error When Clicking Apple Wallet Button

## Problem

When clicking "Add to Apple Wallet" button in email, you see:
- **404 Error**
- URL shows: `s-projects-e802f152.vercel.app` (preview deployment)
- Should be: `www.zorinastudio-referral.com` (production)

## Root Cause

The email HTML contains the **preview deployment URL** instead of the production domain. This means:
1. The email was sent before the code fix was deployed to Vercel, OR
2. Vercel is still using cached/old code when sending emails

## Verification

‚úÖ **Production endpoint works:**
```bash
curl -I "https://www.zorinastudio-referral.com/api/wallet/pass/2A47E49DFEAC4394"
# Returns: HTTP/2 200 ‚úÖ
```

‚ùå **Preview endpoint doesn't work:**
```bash
curl -I "https://referral-system-salon-fbbq6x1wt-umis-projects-e802f152.vercel.app/api/wallet/pass/2A47E49DFEAC4394"
# Returns: HTTP/2 404 ‚ùå
```

## Solution

### Step 1: Verify Code is Deployed

1. Go to Vercel Dashboard
2. Check latest deployment
3. Verify commit `98a0a7c` is deployed
4. If not, trigger a new deployment

### Step 2: Clear Build Cache

1. Vercel Dashboard ‚Üí Settings ‚Üí General
2. Click "Clear Build Cache"
3. Redeploy

### Step 3: Send Fresh Email from Production

After deployment, send a test email directly from the production API:
```bash
curl "https://www.zorinastudio-referral.com/api/test-giftcard-email?email=umit0912@icloud.com&gan=2A47E49DFEAC4394"
```

This ensures the email is generated by the deployed code on Vercel.

### Step 4: Check Email HTML

1. Open the NEW email
2. View email source/HTML
3. Search for "wallet/pass"
4. Should see: `https://www.zorinastudio-referral.com/api/wallet/pass/...`
5. Should NOT see: `https://referral-system-salon-*.vercel.app/api/wallet/pass/...`

## Why This Happens

- **Local code is correct** ‚úÖ
- **Code is committed** ‚úÖ
- **But Vercel may not have deployed it yet** ‚ùå
- **Or Vercel is using cached code** ‚ùå

## Next Steps

1. ‚úÖ Verify Vercel deployment includes latest commit
2. ‚úÖ Clear build cache
3. ‚úÖ Send fresh email from production API endpoint
4. ‚úÖ Test the new email - should work!

