# ‚ö†Ô∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è: `url.parse()` DeprecationWarning

## üìã –ü—Ä–æ–±–ª–µ–º–∞

–í –ª–æ–≥–∞—Ö Vercel –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:
```
(node:4) [DEP0169] DeprecationWarning: `url.parse()` behavior is not standardized and prone to errors that have security implications. Use the WHATWG URL API instead. CVEs are not issued for `url.parse()` vulnerabilities.
```

## üîç –ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç

–≠—Ç–æ **–Ω–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞**, –∞ **–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ** –æ —Ç–æ–º, —á—Ç–æ:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –º–µ—Ç–æ–¥ `url.parse()` –∏–∑ –º–æ–¥—É–ª—è `url`
- –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π WHATWG URL API

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å (–≤—Ä–µ–º–µ–Ω–Ω–æ)

–≠—Ç–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ **–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã**. –ú–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å, –µ—Å–ª–∏:
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- ‚úÖ Email –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ù–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ì–¥–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–∞:**
- –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö (node_modules) - –æ–±—ã—á–Ω–æ –≤ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏—è—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
- –í –≤–∞—à–µ–º –∫–æ–¥–µ - –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `url.parse()`

**–ö–∞–∫ –Ω–∞–π—Ç–∏:**
```bash
# –ù–∞–π—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ url.parse –≤ –∫–æ–¥–µ
grep -r "url.parse" . --exclude-dir=node_modules

# –ù–∞–π—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ require('url')
grep -r "require(['\"]url['\"])" . --exclude-dir=node_modules
```

**–ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:**

–ó–∞–º–µ–Ω–∏—Ç—å:
```javascript
const url = require('url')
const parsed = url.parse(urlString)
```

–ù–∞:
```javascript
const parsed = new URL(urlString)
```

## üîç –ì–¥–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–∞

### 1. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö (node_modules)

–ß–∞—Å—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏—è—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫:
- `@sendgrid/mail` - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–¥
- `@square/square-sdk` - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–¥
- –î—Ä—É–≥–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
npm update
```

### 2. –í –≤–∞—à–µ–º –∫–æ–¥–µ

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `url.parse()` –≤ —Å–≤–æ–µ–º –∫–æ–¥–µ, –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ `new URL()`.

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

**–í –≤–∞—à–µ–º –∫–æ–¥–µ:**
- ‚úÖ –ù–µ –Ω–∞–π–¥–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `url.parse()` –Ω–∞–ø—Ä—è–º—É—é
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π `new URL()` –≤ `lib/prisma-client.js`

**–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö:**
- ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω–æ, –∫–∞–∫–∞—è-—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞—Ä—ã–π `url.parse()`

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–°–µ–π—á–∞—Å:** –ú–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å - —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ
2. **–ü–æ–∑–∂–µ:** –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `npm update`
3. **–ï—Å–ª–∏ –Ω—É–∂–Ω–æ:** –ù–∞–π—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –∏ –æ–±–Ω–æ–≤–∏—Ç—å –µ—ë

## üîß –ö–∞–∫ –Ω–∞–π—Ç–∏ –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –Ω–∞–π—Ç–∏ —Ç–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å trace (–ø–æ–∫–∞–∂–µ—Ç —Å—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤)
node --trace-deprecation scripts/retry-failed-emails.js

# –ò–ª–∏ –¥–ª—è –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
NODE_OPTIONS="--trace-deprecation" npm run dev
```

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç —Ç–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `url.parse()`.

## üîá –ö–∞–∫ –ø–æ–¥–∞–≤–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ (–µ—Å–ª–∏ –æ–Ω–æ –∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)

–ï—Å–ª–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∏–¥–µ—Ç –∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—É—é –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å, –º–æ–∂–Ω–æ –ø–æ–¥–∞–≤–∏—Ç—å –µ–≥–æ:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–î–æ–±–∞–≤—å—Ç–µ –≤ `.env` –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Vercel:
```bash
NODE_OPTIONS="--no-deprecation"
```

–ò–ª–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:
```bash
NODE_OPTIONS="--no-warnings"
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –í –∫–æ–¥–µ (–≤ –Ω–∞—á–∞–ª–µ –≥–ª–∞–≤–Ω–æ–≥–æ —Ñ–∞–π–ª–∞)

```javascript
// –ü–æ–¥–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ DEP0169 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
process.removeAllListeners('warning')
process.on('warning', (warning) => {
  if (warning.name === 'DeprecationWarning' && warning.message.includes('url.parse()')) {
    // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º —ç—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
    return
  }
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
  console.warn(warning.name, warning.message)
})
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ –æ–±–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `url.parse()`:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø–∞–∫–µ—Ç—ã
npm outdated

# –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö –≤–µ—Ä—Å–∏–π
npm update

# –ò–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
npm install @sendgrid/mail@latest square@latest nodemailer@latest
```

## üì¶ –í–µ—Ä–æ—è—Ç–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

–ù–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:
- `@sendgrid/mail@^8.1.6` - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π API
- `square@^39.1.1` - Square SDK –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–¥
- `nodemailer@^7.0.10` - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å url.parse()
- `passkit-generator@^3.5.5` - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π API
- `twilio@^5.10.6` - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å url.parse()
- `qrcode@^1.5.4` - –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å url.parse()

## ‚úÖ –ò—Ç–æ–≥–æ

- ‚ö†Ô∏è –≠—Ç–æ **–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ**, –∞ –Ω–µ –æ—à–∏–±–∫–∞
- ‚úÖ **–ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã**
- ‚úÖ Email –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- ‚úÖ –í–∞—à –∫–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π `new URL()` API
- üí° –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∏–¥–µ—Ç –∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –Ω–µ –∏–∑ –≤–∞—à–µ–≥–æ –∫–æ–¥–∞
- üîß –ú–æ–∂–Ω–æ –ø–æ–¥–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ `NODE_OPTIONS` –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

